{
    "blocks": [
        {
            "Name": "demo_block_sendContract",
            "Value": "SetTitle($demo_title$)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-lg-8 col-lg-offset-2){\n            Div(h4){LangRes(input)}\n            Div(Class: panel panel-primary){\n                Form(panel-body input-group){\n                    Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n                    Div(input-group-btn){\n                        Button(Body:Send to Contract, Contract: DemoContract, Page: demo_page_sendContract, Class:btn btn-primary)\n                    }\n                }\n            }\n            \n            \n            DBFind(Name:demo_page_table, Source: me_table_exist).Where(\"id>0\").Vars(exist)\n            If(#exist_id#>0){\n                Div(h4){LangRes(result)}\n                Div(Class: panel panel-primary){\n                    Div(panel-body){\n                        DBFind(Name:demo_page_table, Source: my_table)\n                        Div(table-responsive){\n                            Table(Source: my_table, Columns:\"id=member_id,name=member_name,text=some_text\")\n                        }\n                    }\n                }\n            }\n            \n            Div(h4){LangRes(code)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    Code(\nForm(panel-body input-group){\n    Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n    Div(input-group-btn){\n        Button(Body:Send to Contract, Contract: DemoContract, Page: demo_page_sendContract, Class:btn btn-primary)\n    }\n}\nDBFind(Name:demo_page_table, Source: my_table)\nDiv(table-responsive){\n    Table(Source: my_table, Columns:\"id=member_id,name=member_name,text=some_text\")\n}\n                    )\n                    \n                }\n            }\n            \n            Div(h4){LangRes(description)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    LangRes(demo_description_sendContract)\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "demo_block_sendMessage",
            "Value": "SetTitle($demo_title$)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-lg-8 col-lg-offset-2){\n            \n            Div(h4){LangRes(input)}\n            Div(Class: panel panel-primary){\n                Form(panel-body){\n                    Div(col-sm-6){\n                        Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n                    }\n                    Div(col-sm-6){\n                        Div(input-group){\n                            DBFind(Name: member, Source: src_member)\n                            Select(Name: MemberId, Source: src_member, NameColumn: member_name, ValueColumn: id)\n                            Div(input-group-btn){\n                                Button(Body: Send Notification, Contract: DemoNotificationSingle, Class:btn btn-primary, Params: \"MemberId=Val(MemberId)\")\n                            }\n                        }\n                    }\n                }\n            }\n            \n            Div(h4){LangRes(code)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    Strong(Page)\n                    Div(){\nCode(\nForm(panel-body){\n    Div(col-sm-6){\n        Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n    }\n    Div(col-sm-6){\n        Div(input-group){\n            DBFind(Name: member, Source: src_member)\n            Select(Name: MemberId, Source: src_member, NameColumn: member_name, ValueColumn: id)\n            Div(input-group-btn){\n                Button(Body: Send Notification, Contract: DemoNotificationSingle, Class:btn btn-primary, Params: \"MemberId=Val(MemberId)\")\n            }\n        }\n    }\n}\n)\n                    }\n                    Strong(Contract)\n                    Form(){\nCode(\ncontract DemoNotificationSingle {\n  data {\n    MemberId int\n    SomeText string\n  }\n  \n  conditions {\n    $iconName = \"fa-bell\"\n    $textHeader=\"You got a message\"\n    $pageName=\"demo_page_message\"\n    $paramsVal= Sprintf(\"SomeText=%v\", $SomeText)\n    $textBody = $SomeText\n  }\n  \n  action {\n    Notifications_Single_Send(\"MemberId,IconName,TextHeader,TextBody,PageName,ParamsVal\", $MemberId, $iconName, $textHeader, $textBody, $pageName, $paramsVal)\n  }\n}    \n)\n                        \n                    }\n                }\n            }\n            \n            Div(h4){LangRes(description)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    LangRes(demo_description_sendMessage)\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "demo_block_sendPage",
            "Value": "SetTitle($demo_title$)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-lg-8 col-lg-offset-2){\n            Div(h4){LangRes(input)}\n            Div(Class: panel panel-primary){\n                Form(panel-body input-group){\n                    Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n                    Div(input-group-btn){\n                        Button(Body:Send to Page, Page:demo_page_sendPage, PageParams: \"pageValue=Val(SomeText)\", Class:btn btn-primary)\n                    }\n                }\n            }\n            \n            \n            Div(h4){LangRes(result)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    pageValue : #pageValue#\n                }\n            }\n            \n            Div(h4){LangRes(code)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    Code(\nForm(panel-body input-group){\n    Input(Name: SomeText, Type:text, Placeholder:Enter text, Value: Hello World!)\n    Div(input-group-btn){\n        Button(Body:Send to Page, Page:demo_page_sendPage, PageParams: \"pageValue=Val(SomeText)\", Class:btn btn-primary)\n    }\n}\n                    )\n                }\n            }\n            \n            Div(h4){LangRes(description)}\n            Div(Class: panel panel-primary){\n                Div(panel-body){\n                    LangRes(demo_description_sendPage)\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        }
    ],
    "contracts": [
        {
            "Name": "DemoContract",
            "Value": "contract DemoContract {\n    data {\n        SomeText string\n    }\n    \n    conditions {\n        $memberFind = DBFind(\"member\").WhereId($key_id)\n        if Len($memberFind) == 0{\n            info \"Member not found\"\n        }\n        $member = $memberFind[0]\n    }\n    action {\n        DBInsert(\"demo_page_table\", \"member_name,member_id,some_text\", $member[\"username\"], $member[\"id\"], $SomeText)\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "Notifications_Single_Send",
            "Value": "contract Notifications_Single_Send {\n  data {\n    MemberId int\n    IconName string\n    TextHeader string\n    TextBody string\n    PageName string\n    ParamsVal string\n  }\n  \n  conditions {\n    $member_map = DBFind(\"member\").Where(\"id = $\", $MemberId).Row()\n    \n    if($member_map[\"id\"] == nil){\n      warning \"Member not found\"\n    }\n  }\n  \n  action {\n    $notification_id = DBInsert(`notifications`, `icon,header_text,body_text,page_name,notification_type,recipient_id,recipient_name,recipient_avatar,timestamp date_create`,\n      $IconName, $TextHeader, $TextBody, $PageName, 1, $MemberId, $member_map[\"member_name\"], $member_map[\"avatar\"], $block_time)\n      \n      var params string\n      params = \"NotificId=\" + Str($notification_id) + \",\"\n      params = params + \"NotificType=1,\"\n      params = params + \"NotificHeader=\" + $TextHeader + \",\"\n      params = params + $ParamsVal\n      \n      DBUpdate(`notifications`, $notification_id, `page_params`, params)\n    }\n  }",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "Profile_Edit",
            "Value": "contract Profile_Edit {\n    data {\n        Username string\n        Avatar string \"image\"\n    }\n    \n    conditions {\n        $id = 0\n        $memberFind = DBFind(\"member\").WhereId($key_id)\n        if Len($memberFind) > 0 {\n            $member = $memberFind[0]\n            $id = Int($member[\"id\"])\n        }\n    }\n    \n    action {\n        if $id == 0{\n            DBInsert(\"member\", \"id,member_name,avatar\", $key_id, $Username, $Avatar)\n        }else{\n            DBUpdate(\"member\", $id, \"member_name,avatar\", $Username, $Avatar)\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "Notifications_Single_Close",
            "Value": "contract Notifications_Single_Close {\n    data {\n        NotificId int\n    }\n    action {\n        DBUpdate(`notifications`, $NotificId, `closed,timestamp finished_processing_time,finished_processing_id`, 1, $block_time, $key_id)\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "DemoNotificationSingle",
            "Value": "contract DemoNotificationSingle {\n  data {\n    MemberId int\n    SomeText string\n  }\n  \n  conditions {\n    $iconName = \"fa-bell\"\n    $textHeader=\"You got a message\"\n    $pageName=\"demo_page_message\"\n    $paramsVal= Sprintf(\"SomeText=%v\", $SomeText)\n    $textBody = $SomeText\n  }\n  \n  action {\n    Notifications_Single_Send(\"MemberId,IconName,TextHeader,TextBody,PageName,ParamsVal\", $MemberId, $iconName, $textHeader, $textBody, $pageName, $paramsVal)\n  }\n}\n",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "MemberAutoreg",
            "Value": "contract MemberAutoreg {\n    conditions {\n    }\n    \n    action {\n        var i int\n        while true{\n            $name = Sprintf(\"member_%v\", i)\n            $member = DBFind(\"member\").Where(\"member_name=?\", $name).Row()\n            if !$member{\n                break\n            }\n            i = i+1\n        }        \n        Profile_Edit(\"Username,Avatar\", $name, \"\")\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        }
    ],
    "data": [],
    "languages": [
        {
            "Name": "close",
            "Conditions": "",
            "Trans": "{\"en\":\"Close\",\"ru\":\"Закрыть\"}"
        },
        {
            "Name": "code",
            "Conditions": "",
            "Trans": "{\"en\":\"Code\",\"ru\":\"Код\"}"
        },
        {
            "Name": "demo_description_sendContract",
            "Conditions": "",
            "Trans": "{\"en\":\"Send some parameter to contract `DemoContract`\",\"ru\":\"Отправить параметр в контракт `DemoContract`\"}"
        },
        {
            "Name": "demo_description_sendMessage",
            "Conditions": "",
            "Trans": "{\"en\":\"Send direct message to ecosystem member\",\"ru\":\"Отправить сообщение члену экосистемы\"}"
        },
        {
            "Name": "demo_description_sendPage",
            "Conditions": "",
            "Trans": "{\"en\":\"Send some text on this page\",\"ru\":\"Отправить какой-то текст на эту страницу\"}"
        },
        {
            "Name": "demo_sendContract",
            "Conditions": "",
            "Trans": "{\"en\":\"Send to contract\",\"ru\":\"Передача в контракт\"}"
        },
        {
            "Name": "demo_sendMessage",
            "Conditions": "",
            "Trans": "{\"en\":\"Send a text parameter to a notification\",\"ru\":\"Передача текстового параметра в оповещении\"}"
        },
        {
            "Name": "demo_sendPage",
            "Conditions": "",
            "Trans": "{\"en\":\"Send to page\",\"ru\":\"Передача на страницу\"}"
        },
        {
            "Name": "demo_title",
            "Conditions": "",
            "Trans": "{\"en\":\"Demonstration\",\"ru\":\"Демонстрация\"}"
        },
        {
            "Name": "demo_welcome",
            "Conditions": "",
            "Trans": "{\"en\":\"Welcome!\",\"ru\":\"Добро пожаловать!\"}"
        },
        {
            "Name": "description",
            "Conditions": "",
            "Trans": "{\"en\":\"Description\",\"ru\":\"Описание\"}"
        },
        {
            "Name": "input",
            "Conditions": "",
            "Trans": "{\"en\":\"Input\",\"ru\":\"Ввод\"}"
        },
        {
            "Name": "membership",
            "Conditions": "",
            "Trans": "{\n    \"en\": \"Memberships\",\n    \"ru\": \"Члены экосистемы\"\n}"
        },
        {
            "Name": "notifications",
            "Conditions": "",
            "Trans": "{\n    \"en\": \"Notifications\",\n    \"ru\": \"Оповещения\"\n}"
        },
        {
            "Name": "profile_edit",
            "Conditions": "",
            "Trans": "{\n    \"en\": \"Profile edit\",\n    \"ru\": \"Редактирование профиля\"\n}"
        },
        {
            "Name": "result",
            "Conditions": "",
            "Trans": "{\"en\":\"Result\",\"ru\":\"Результат\"}"
        },
        {
            "Name": "store",
            "Conditions": "",
            "Trans": "{\"en\":\"Store\",\"ru\":\"Сохранить\"}"
        }
    ],
    "menus": [
        {
            "Name": "demo_menu",
            "Value": "MenuItem(Title: $demo_sendPage$, Page: demo_page_sendPage)\nMenuItem(Title: $demo_sendContract$, Page: demo_page_sendContract)\nMenuItem(Title: $demo_sendMessage$, Page: demo_page_sendMessage)\nMenuItem(Title: $notifications$, Page: notifications)\nMenuItem(Title: $profile_edit$, Page: demo_profile_edit)",
            "Conditions": "ContractConditions(\"MainCondition\")"
        }
    ],
    "pages": [
        {
            "Name": "default_page",
            "Value": "Include(demo_block_sendMessage)",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_member_list",
            "Value": "SetTitle($membership$)\nDiv(Class: content-wrapper){\n    If(GetVar(isSearch) == 1){\n        SetVar(Name: v_Where, Value: \"member_name='#v_Search#'\")\n    }.Else{\n        SetVar(Name: v_Where, Value: \"id!=0\")\n        SetVar(Name: v_Search, Value: \"\")\n    }\n    \n    DBFind(Name: member, Source: src_member).Custom(_username){\n        LinkPage(Page: demo_profile_view, PageParams: \"v_id=#id#\"){\n            Image(Src: \"#avatar#\", Class: img-circle).Style(width: 30px; border: 1px solid #5A5D63; margin-right: 10px;)\n            Span(Class: h5 text-bold, Body: #member_name#)\n        }\n    }.Custom(_id){\n        Span(Body: Address(#id#))\n    }.Where(#v_Where#).Order(\"id\")\n    \n    Div(Class: panel panel-primary){\n        Form(){\n            Div(Class: list-group-item){\n                Div(Class: row df f-valign){\n                    Div(Class: col-md-1 mt-sm text-right){\n                        Label(For: Search){\n                            Span(Body: LangRes(username))\n                        }\n                    }\n                    Div(Class: col-md-11 mc-sm){\n                        Div(Class: input-group){\n                            Input(Class: form-control, Type: text, Name: Search, Value: #v_Search#)\n                            Div(Class: input-group-btn){\n                                Button(Body: Em(Class: fa fa-search), Class: btn btn-default, Page: members_list, PageParams: \"isSearch=1,v_Search=Val(Search)\")\n                            }\n                        }\n                    }\n                }\n            }\n            \n            Div(Class: list-group-item){\n                Table(Source: src_member, Columns: \"username=_username,id=_id\")\n                If(GetVar(isSearch) == 1){\n                    Div(Class: text-center){\n                        Button(Body: $view_all$, Class: btn btn-primary, Page: demo_members_list, PageParams: \"isSearch=0\")\n                    }\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_page_message",
            "Value": "If(#NotificId#>0){\n    SetTitle($demo_sendMessage$)\n    Div(content-wrapper){\n        Div(row){\n            Div(col-xs-8 col-xs-offset-2 col-lg-6 col-lg-offset-3){\n                Div(panel panel-primary){\n                    Div(panel-heading){$result$}\n                    Div(panel-body){\n                        Div(row){\n                            Div(col-sm-10 col-sm-offset-1 alert alert-default){\n                                Div(){TextHeader: #NotificHeader#}\n                                Div(){SomeText: #SomeText#}\n                            }\n                            \n                        }.Style(display: flex;align-items: flex-end;)\n                    }\n                    Div(panel-footer clearfix){\n                        Div(pull-right text-right){\n                            Button(Page: demo_page_sendMessage, Class: btn btn-primary, Contract:Notifications_Single_Close, Params:\"NotificId=#NotificId#\", Body: $close$)\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_page_sendContract",
            "Value": "Include(demo_block_sendContract)",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_page_sendMessage",
            "Value": "Include(demo_block_sendMessage)",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_page_sendPage",
            "Value": "Include(demo_block_sendPage)",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_profile_edit",
            "Value": "Div(Class: content-wrapper){\n    \n    If(Or(#v_id#>0,#v_id#<0)){\n        DBFind(Name: member, Source: src_member).Where(id=#v_id#).Vars(prefix)\n    }.Else{\n        DBFind(Name: member, Source: src_member).Where(id=#key_id#).Vars(prefix)\n    }\n    \n    Div(Class: row){\n        Div(Class: col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\n            Div(Class: panel panel-primary){\n                Div(Class: panel-heading, Body: LangRes(profile_edit))\n                Form(){\n                    Div(Class: list-group-item){\n                        Div(Class: row){\n                            Div(Class: col-md-3 mt-sm text-right){\n                                Label(For: username){\n                                    Span(Body: LangRes(username))\n                                    Span(Class: text-danger, Body:*)\n                                }\n                            }\n                            Div(Class: col-md-9 mt-sm text-left){\n                                Input(Class: form-control, Type: text, Name: Username, Value: #prefix_member_name#)\n                            }\n                        }\n                    }\n                    \n                    Div(Class: list-group-item){\n                        Div(Class: row){\n                            Div(Class: col-md-3 mt-sm text-right){\n                                Label(For: avatar){\n                                    Span(Body: LangRes(avatar))\n                                    Span(Class: text-danger, Body:*)\n                                }\n                            }\n                            Div(col-md-9 mc-sm text-left){\n                                ImageInput(Name: Avatar, Width: 100, Ratio: 1/1)\n                            }\n                        }\n                    }\n                    \n                    Div(Class: panel-footer clearfix){\n                        Div(Class: pull-right){\n                            Button(Body: LangRes(save), Class: btn btn-primary, Contract: Profile_Edit, Page: demo_member_list,).Alert(Text: Do you want to save changes?, ConfirmButton: yes, CancelButton: no, Icon: question)\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "demo_profile_view",
            "Value": "SetTitle($user_info$)\nDiv(Class: content-wrapper){\n    If(Or(#v_id#>0,#v_id#<0)){\n    }.Else{\n        SetVar(Name: v_id, Value: #key_id#)\n    }\n    DBFind(Name: member, Source: src_member).Where(id=#v_id#).Vars(prefix)\n    DBFind(Name: keys, Source: src_keys).Where(id=#v_id#).Vars(tokens)\n    \n    \n    If(Or(#prefix_id#>0,#prefix_id#<0)){\n    }.Else{\n        SetVar(Name: prefix_username, Value: \"\")\n    }\n    \n    Div(Class: row){\n        Div(Class: col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\n            Div(Class: panel panel-default){\n                Form(){\n                    Div(Class: list-group-item){\n                        Div(Class: row){\n                            Div(Class: col-md-12 mt-sm text-center){\n                                If(#prefix_id# > 0){\n                                    If(#prefix_id# == #key_id#){\n                                        Button(Class: btn btn-link, Page: demo_profile_edit, PageParams: \"v_id=#id#\"){\n                                            Image(Src: \"#prefix_avatar#\", Class: img-circle).Style(width: 100px; border: 1px solid #5A5D63; margin-bottom: 15px;)\n                                            Div(Body: Span(Class: h3 text-bold, Body: #prefix_username#))\n                                        }\n                                    }.Else{\n                                        Image(Src: \"#prefix_avatar#\", Class: img-circle).Style(width: 100px; border: 1px solid #5A5D63; margin-bottom: 15px;)\n                                        Div(Body: Span(Class: h3 text-bold, Body: #prefix_username#))\n                                    }\n                                }.Else{\n                                    Button(Class: btn btn-link, Page: demo_profile_edit){\n                                        Span(Class: h3 text-bold, Body: LangRes(editing_profile))\n                                    }\n                                }\n                                \n                            }\n                        }\n                    }\n                    Div(Class: list-group-item){\n                        Div(Class: row){\n                            Div(Class: col-md-12 mt-sm text-center){\n                                Span(Class: h4 text-bold, Body: Address(#prefix_id#))\n                                Div(Class: text-muted m0 h5, Body: LangRes(member_id))\n                            }\n                        }\n                    }\n                    \n                }\n            }\n            \n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        },
        {
            "Name": "notifications",
            "Value": "DBFind(Name: notifications, Source: noti_s).Where(\"closed=0 and notification_type=1 and recipient_id=#key_id#\")\n\nForList(noti_s){\n    Div(Class: list-group-item){\n        LinkPage(Page: #page_name#, PageParams: \"#page_params#\"){\n            Div(media-box){\n                Div(Class: pull-left){\n                    Em(Class: fa #icon# fa-1x text-info)\n                }\n                Div(media-box-body clearfix){\n                    Div(Class: m0 text-normal, Body: #header_text#)\n                    Div(Class: m0 text-muted h6, Body: #body_text#)\n                }\n            }\n        }\n    }\n}\n\n",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "demo_menu"
        }
    ],
    "parameters": [],
    "tables": [
        {
            "Name": "demo_page_table",
            "Columns": "[{\n    \"name\": \"member_name\",\n    \"type\": \"text\",\n    \"conditions\": \"true\"\n}, {\n    \"name\": \"member_id\",\n    \"type\": \"number\",\n    \"conditions\": \"true\"\n}, {\n    \"name\": \"some_text\",\n    \"type\": \"text\",\n    \"conditions\": \"true\"\n}]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        }
    ]
}